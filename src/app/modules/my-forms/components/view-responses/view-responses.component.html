<mat-toolbar color="primary" class="nav-bar">
  <div class="logo">
    <a routerLink="/" aria-label="Home">FormSphere</a>
  </div>
  <div class="nav">
    <ul>
      <li>
        <a mat-button routerLink="/templates" aria-label="Templates">Templates</a>
      </li>
      <li>
        <a mat-button routerLink="/create-form" aria-label="Create Form">Create Form</a>
      </li>
      <li>
        <a mat-button routerLink="/my-forms" aria-label="My Forms">My Forms</a>
      </li>
      <li>
        <a mat-button routerLink="/analytics/{{formId}}" aria-label="Analytics">Analytics</a>
      </li>
    </ul>
  </div>
  <button mat-stroked-button aria-label="LogOut button" class="logout" (click)="logoutUser()">
    Logout
  </button>
</mat-toolbar>

<!-- Search Bar -->
<div class="search-container">
  <input
    type="text"
    class="search-input"
    placeholder="Search by name or email..."
    [(ngModel)]="searchQuery"
    (ngModelChange)="filterResponses()"
    aria-label="Search"
  />
</div>

<!-- Responses container -->
<div class="responses-container">
  <h1>Responses</h1>

  <ng-container *ngIf="filteredResponses.length > 0; else noResponses">
    <div *ngFor="let response of filteredResponses" class="response-card">
      <h2>User: {{ response.userName }} ({{ response.userEmail }})</h2>
      <p>Submitted on: {{ response.createdAt | date: 'medium' }}</p>

            <div class="form-preview">
        <ng-container *ngFor="let answer of response.answers">
          <ng-container [ngSwitch]="answer.questionType">
            <!-- Heading -->
            <h1 *ngSwitchCase="'heading'" class="form-header">
              {{ answer.questionText }}
            </h1>
      
            <!-- File -->
            <div *ngSwitchCase="'file'" class="form-field">
              <p class="question-text">{{ answer.questionText }}</p>
              <a href="#" (click)="downloadFile(answer.responseAnswer); $event.preventDefault()">
                Download File
              </a>
            </div>

            <!-- Signature -->
            <div *ngSwitchCase="'signature'" class="form-field">
              <p class="question-text">{{ answer.questionText }}</p>
              <img [src]="answer.responseAnswer" alt="Signature" class="signature-preview" />
            </div>
      
            <!-- Default -->
            <div *ngSwitchDefault class="form-field">
              <p class="question-text">{{ answer.questionText }}</p>
              <p>{{ answer.responseAnswer }}</p>
            </div>
          </ng-container>
        </ng-container>
      </div>
    </div>
  </ng-container>

  <ng-template #noResponses>
    <div class="no-responses">
      <p>No responses available for this form.</p>
    </div>
  </ng-template>
</div>
